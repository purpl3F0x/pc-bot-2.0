TODO: add delay to hal direct messages